# 交通事故データの地図可視化

交通事故データを用いて **事故発生地点の分布**および **リンク別の事故件数**を地図上に可視化


## 実施内容

- 警察庁交通事故データに含まれる事故発生地点の緯度・経度を整理
- 度分秒（DMS）形式で与えられていた座標を十進度（DD）に変換
- 2019–2024 年の事故データを用いて以下を作成
  - 事故発生地点の点プロット地図
  - BLink リンクへの最近接割当によるリンク別事故件数地図
- 地図描画時は、可視化が重くならないよう **事故が発生したリンクのみを表示**

### 交通事故データ
- 出典：警察庁「交通事故統計情報（本票）」
- 対象年：2019–2024 年
- 抽出条件：
  - 都道府県コード：73（広島県）
  - 警察署等コード：112
- 主な使用項目：
  - 事故発生地点の緯度・経度
  - 市区町村コード
  - 発生年

| 年 | 事故件数 |
|----|---------:|
| 2019 | 513 |
| 2020 | 316 |
| 2021 | 365 |
| 2022 | 324 |
| 2023 | 377 |
| 2024 | 297 |
| **合計** | **2,192** |



#### 座標データについて
- 緯度・経度は **世界測地系・度分秒（DMS）形式を 10⁷ 倍した整数値**として格納されていた
- 本研究ではこれを十進度（DD）形式に正しく変換（lat_dd / lon_dd）した上で使用している
## 作成した地図（Outputs）

- **事故点プロット地図（2019–2024）**  
  ![6A3BCD40-803F-4BCA-960F-FC38F9C3B594_1_201_a](https://github.com/user-attachments/assets/9202e365-06f7-4de3-8658-4280965c10c7)


- **リンク別事故件数地図（2019–2024 合計）**  
  （最近接距離の閾値：300 m）  
  ![42BF0354-2D67-4189-9E15-528736CC71B7_1_201_a](https://github.com/user-attachments/assets/8b1ec008-4296-487c-8180-9288e2e8b8a5)








## 分析手法の概要

- 事故発生地点（点）を、距離計算用の座標系（UTM）に変換
- 各事故点について、最も近い BLink リンクを検索
- 最近接距離が 300 m 以下のものを有効な割当として採用
- リンク ID ごとに事故件数を集計
- 集計結果をリンク形状と結合し、地図上に可視化



## 今後の予定
- プローブ通過台数データを用いた事故件数の正規化

---

# 事故件数の正規化（通過台数による事故率）

リンク別事故件数は交通量に依存するため、プローブ通過台数データを用いて事故件数を正規化し、**リンク別事故率（事故/通過台数）**を作成・可視化した。

## 使用データ（通過台数）

- 出典：BLink プローブデータ（リンク通過記録）
- 対象期間：9/1–12/31（122日）
- 集計方法：
  - 日別ファイル（0901.parquet〜1231.parquet）を対象に
  - 各日・各リンクについて **ユニーク車両数（vin_sha256）** を通過台数として集計
  - 期間内（9/1–12/31）でリンク別に合計し、曝露量（exposure proxy）として利用

> 注意：本通過台数はトヨタコネクティッドカー（BLink）由来の観測であり、全交通量ではない。ただし、リンク間の相対的な曝露量比較に基づく事故率評価には有効と考えられる。

## 指標（事故率）

- リンク別事故件数（2019–2024合計）を、リンク別通過台数（9/1–12/31合計）で除して事故率を算出した。

事故率（件/1万台） = (事故件数 / 通過台数) × 10,000


- 可視化の安定性のため、通過台数が小さいリンクは事故率が過大になりやすい。そこで地図表示では以下の条件でフィルタリングを行った：
  - **通過台数が一定以上（例：MIN_EXPOSURE = 50）**
  - **事故率 > 0 のリンクのみ表示**
  - 色分けは外れ値の影響を避けるため、上位分位点（例：95%）でクリップ

## 作成した地図

- **リンク別事故率地図（件/1万台）**  
  （最近接距離の閾値：300 m、通過台数下限：MIN_EXPOSURE = 50）  
  ![D1FAEF8C-C89E-4F71-91C6-21976453ED0C_1_201_a](https://github.com/user-attachments/assets/bf1dd44b-50bd-4e55-a73f-8bc2335894b9)

  



